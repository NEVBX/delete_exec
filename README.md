# delete_exec
Этот простенький PowerShell скрипт предназначен для ограничения скачивания файлов указанного типа, например exe. ИСПОЛЬЗУЙТЕ НА СВОЙ СТРАХ И РИСК.

Перед использованием скрипта, вам необходимо открыть его с помощью блокнота или любого другого текстового редактора,
и изменить следующие параметры:

1. **$TargerFolder** - Папка, в которой будут удаляться файлы выбранного типа.
   Пример: `"C:\Users\username\Downloads"`. По умолчанию: `"PATH HERE"`;

2. **$FileType** - Сам тип файла, который будет удаляться в выбранной папке.
   Пример: `"\*.exe"`. По умолчанию: `"\*.exe"`. Выбрать можно только один тип;

3. **$DeepScan** - Включает "глубокое сканирование". Сканирование подпапок, и удаление файлов выбранного типа соответсвтенно.
   САМАЯ ОПАСНАЯ ОПЦИЯ, так как удаляются вообще все файлы выбранного типа.
   При включении этой опции, крайне не рекомендуется выбирать папку по типу `"C:\Users\USERNAME"`, так как вы как-минимум убьете ProgramData.
   Варианты: `$true` или `$false`;

4. **$Interval**
   Интервал сканирования папки на наличие указанных файлов. Чем меньше - тем лучше, но чем меньше - тем сильнее нагрузка на процессор.
   Рекомендуемое значение: от 1 до 3. Значение меньше 1 установлено быть не может.

------------------------------------

Открыть скрипт можно разными методами, например:

**cmd:**
`powershell.exe -ExecutionPolicy Bypass -File "<Полный путь до скрипта ps1>"`

    -ExecutionPolicy - обход ограничения по запуску скрипта
    -File - какой файл соответсвтенно открыть

**PowerShell:**
`"C:\Users\username\Downloads\delete_exec\delete_exec_ru.ps1"`

`cd C:\Users\username\Downloads\delete_exec`
`.\delete_exec_ru.ps1 -WindowStyle Hidden`

    -Соответсвенно, полный путь к скрипту
    -Или сначала переход в папку со скриптом, а затем его запуск
    -WindowStyle - параметр отображения окна. В данном случае, окно закроется, а скрипт будет работать в фоне.

**Либо через интерфейс:**

    -Нажмите правой кнопкой по файлу скрипта
    -Нажмите "Выполнить с помощью PowerShell"

------------------------------------

Однако, возможно, у вас не получится запустить этот скрипт с первого раза, так как политика стоит ограниченная.
Чтобы иметь возможность открывать любой PowerShell скрипт, тем более неподписанный, вам нужно:

    -Открыть PowerShell от имени администратора
    -Вписать `Set-ExecutionPolicy Unrestricted` и выбрать "Да" или "Да для всех"
    -Это позволит запускать вам любой неподписанный PowerShell скрипт в будущем
    -Стоит понимать, что это довольно сильно подрывает безопасность вашего устройства. Будьте бдительны.
    -Либо, вы просто можете запускать скрипт с параметром -ExecutionPolicy Bypass

------------------------------------

Очевидно, что вам необходимо, чтобы этот скрипт автоматически запускался и работал в фоне.
Поэтому, давайте разберемся, как настроить его в Планировщике Заданий.

    -Откройте планировщик заданий от имени администратора
    -В левой части, перейдите в "Библиотеку планировщика заданий"
    -В правой части, выберите "Создать простую задачу":
       
       -Укажите имя задачи, описание при желании
       -Выберите триггер запуска задачи, например, при входе пользователя в Windows.
       -Выберите "запустить программу"
       -Самое важное. В окно "Программа или сценарий" введите `"powershell.exe"` (без кавычек), а в "Добавить аргументы" введите `-ExecutionPolicy Bypass -File "<полный путь до скрипта ps1>"`
       -В последнем пункте выберите "Открыть окно свойств", чтобы перейти в более подробные настройки

       -Поставьте галочку на "Выполнять с наивысшыми правами", дабы не было никаких косяков
       -Настроить для: Windows 10
       -Здесь же вы можете настроить более подробный триггер, если хотите
       -При выполнении, желательно, оставить учетную запись администратора.

Таким образом, после перезагрузки компьютера (или по срабатыванию триггера), откроется скрипт, который начнет свою работу.
Он будет работать в фоне и не мазолить вам или кому либо глаза.

Также убедитесь, что скрипт лежит в доступной для пользователя папке.

    -К примеру, если для пользователя `"user1"` путь `"C:\ScriptFolder\"` является недоступным, то скрипт по планировщику не откроется.
    -Вы можете, к примеру, запретить доступ для "user1" в родительскую папку `"C:\ScriptFolder\"`, но можете внутри создать ещё одну папку, к примеру "script",
     и уже для этой папки выстовить разрешение на чтение, запись, изменение и прочее, для пользователя "user1".
    -Можете сделать небанальное название папки, ну или зашифровать её название, например под Base64. Главное будет в планировщике указать полный правильный путь.

------------------------------------

Это вся возможная документация которую я из себя выдавил.
Приятного и аккуратного использования!

tg: @vbx403; @NEVBX
